var baidu=baidu||{};baidu.frontia={},function(e){baidu.frontia.version="1.0.0",baidu.frontia.serviceHost={PCS:"https://c.pcs.baidu.com",Frontia:"https://frontia.baidu.com",PBLog:"http://frontialog.smrapp.baidu.com",Social:"https://openapi.baidu.com"},baidu.frontia.currentAccount=null,baidu.frontia.apiKey=null,baidu.frontia._CURRENT_USER_KEY="currentUser","undefined"!=typeof localStorage&&(baidu.frontia.localStorage=localStorage),baidu.frontia.DomainManager={getSocialDomain:function(){return baidu.frontia.serviceHost.Social},getPCSDomain:function(){return baidu.frontia.serviceHost.PCS},getFrontiaDomain:function(){return baidu.frontia.serviceHost.Frontia},getPBLogDomain:function(){return baidu.frontia.serviceHost.PBLog}},baidu.frontia.Base=Object.defineProperty(function(){},"extend",{value:function(e,t){var r=e&&e.hasOwnProperty("constructor")?e.constructor:this,n=function(){r.apply(this,arguments)};if(n.prototype=function(e,t){return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}(Object.create(this.prototype),e||{}),t)for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);return Object.defineProperty(n,"extend",Object.getOwnPropertyDescriptor(this,"extend")),n}}),baidu.frontia.Object=baidu.frontia.Base.extend({acl:null,constructor:function(t){if(t&&!(t instanceof e.ACL))throw new Error("[construct ]: acl is invalid");this.acl=t||null},setAcl:function(t){if(t&&!(t instanceof e.ACL))throw new Error("[setAcl ]: acl is invalid");this.acl=t||null},getACL:function(){return this.acl},_getACLInfo:function(){var t=null;return this.acl instanceof e.ACL&&(t=this.acl.toJSON()),t}}),baidu.frontia.setCurrentAccount=function(t){if(!(t instanceof e.User||t instanceof e.Role))throw new Error("[setCurrentAccount]: account is invalid");var r=t.toJSON();baidu.frontia.localStorage.setItem(baidu.frontia._getLocalStorageKey(baidu.frontia._CURRENT_USER_KEY),JSON.stringify(r)),baidu.frontia.currentAccount=t},baidu.frontia.logOutCurrentAccount=function(){baidu.frontia.currentAccount=null,baidu.frontia.localStorage.removeItem(baidu.frontia._getLocalStorageKey(baidu.frontia._CURRENT_USER_KEY))},baidu.frontia.getCurrentAccount=function(){if(baidu.frontia.currentAccount)return baidu.frontia.currentAccount;var e=baidu.frontia.localStorage.getItem(baidu.frontia._getLocalStorageKey(baidu.frontia._CURRENT_USER_KEY));if(!e)return null;var t=JSON.parse(e);return"user"===t.type?new baidu.frontia.User({socialId:t.socialId,accessToken:t.accessToken,name:t.name,mediaType:t.mediaType,expiresIn:t.expiresIn}):new baidu.frontia.Role(t.roleId)},baidu.frontia.init=function(e){if(!e)throw new Error("[init]: apiKey is invaild");baidu.frontia.apiKey=e},baidu.frontia.getApiKey=function(){return baidu.frontia.apiKey},baidu.frontia._getLocalStorageKey=function(e){if(!baidu.frontia.apiKey)throw"Should call baidu.frontia.init before using baidu.frontia";if(e||(e=""),"string"!=typeof e)throw"userKey must be a string when getting localStorage key";return"baidu.frontia/"+baidu.frontia.apiKey+"/"+e}}(baidu.frontia),"undefined"!=typeof module&&module.exports&&(module.exports=baidu),baidu.frontia.error=baidu.frontia.error||{},function(){baidu.frontia.error=function(e,t){t=t||"error",this.code=e.error_code||e.Code,this.message=e.error_msg||e.Message,this.message+=" ["+t+"]"},baidu.frontia.ERR_MSG={NO_AK:{error_code:-1,error_msg:"No AK found, please config AK by calling BaiduFrontia.init(yourak) at first"},INVALID_AK:{error_code:-1,error_msg:"Invalid AK"},INVALID_PARAMS:{error_code:-1,error_msg:"Invalid params"},INVALID_RES_TYPE:{error_code:-1,error_msg:"Invalid params: response_type"},INVALID_MEDIA_TYPE:{error_code:-1,error_msg:"Invalid params: media_type"}}}(baidu.frontia),function(){"use strict";function e(e,t){var r=e.split("."),n=g;!(r[0]in n)&&n.execScript&&n.execScript("var "+r[0]);for(var a;r.length&&(a=r.shift());)r.length||t===h?n=n[a]?n[a]:n[a]={}:n[a]=t}function t(e,t){if(this.index="number"==typeof t?t:0,this.f=0,this.buffer=e instanceof(m?Uint8Array:Array)?e:new(m?Uint8Array:Array)(32768),2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&r(this)}function r(e){var t,r=e.buffer,n=r.length,a=new(m?Uint8Array:Array)(n<<1);if(m)a.set(r);else for(t=0;n>t;++t)a[t]=r[t];return e.buffer=a}function n(e,t,r){var n,a="number"==typeof t?t:t=0,i="number"==typeof r?r:e.length;for(n=-1,a=7&i;a--;++t)n=n>>>8^R[255&(n^e[t])];for(a=i>>3;a--;t+=8)n=n>>>8^R[255&(n^e[t])],n=n>>>8^R[255&(n^e[t+1])],n=n>>>8^R[255&(n^e[t+2])],n=n>>>8^R[255&(n^e[t+3])],n=n>>>8^R[255&(n^e[t+4])],n=n>>>8^R[255&(n^e[t+5])],n=n>>>8^R[255&(n^e[t+6])],n=n>>>8^R[255&(n^e[t+7])];return(4294967295^n)>>>0}function a(e){this.buffer=new(m?Uint16Array:Array)(2*e),this.length=0}function i(e,t){this.h=S,this.j=0,this.input=m&&e instanceof Array?new Uint8Array(e):e,this.c=0,t&&(t.lazy&&(this.j=t.lazy),"number"==typeof t.compressionType&&(this.h=t.compressionType),t.outputBuffer&&(this.a=m&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.c=t.outputIndex)),this.a||(this.a=new(m?Uint8Array:Array)(32768))}function o(e,t){this.length=e,this.k=t}function s(e,t){function r(e,t){var r,n=e.k,a=[],i=0;r=O[e.length],a[i++]=65535&r,a[i++]=255&r>>16,a[i++]=r>>24;var o;switch(d){case 1===n:o=[0,n-1,0];break;case 2===n:o=[1,n-2,0];break;case 3===n:o=[2,n-3,0];break;case 4===n:o=[3,n-4,0];break;case 6>=n:o=[4,n-5,1];break;case 8>=n:o=[5,n-7,1];break;case 12>=n:o=[6,n-9,2];break;case 16>=n:o=[7,n-13,2];break;case 24>=n:o=[8,n-17,3];break;case 32>=n:o=[9,n-25,3];break;case 48>=n:o=[10,n-33,4];break;case 64>=n:o=[11,n-49,4];break;case 96>=n:o=[12,n-65,5];break;case 128>=n:o=[13,n-97,5];break;case 192>=n:o=[14,n-129,6];break;case 256>=n:o=[15,n-193,6];break;case 384>=n:o=[16,n-257,7];break;case 512>=n:o=[17,n-385,7];break;case 768>=n:o=[18,n-513,8];break;case 1024>=n:o=[19,n-769,8];break;case 1536>=n:o=[20,n-1025,9];break;case 2048>=n:o=[21,n-1537,9];break;case 3072>=n:o=[22,n-2049,10];break;case 4096>=n:o=[23,n-3073,10];break;case 6144>=n:o=[24,n-4097,11];break;case 8192>=n:o=[25,n-6145,11];break;case 12288>=n:o=[26,n-8193,12];break;case 16384>=n:o=[27,n-12289,12];break;case 24576>=n:o=[28,n-16385,13];break;case 32768>=n:o=[29,n-24577,13];break;default:throw"invalid distance"}r=o,a[i++]=r[0],a[i++]=r[1],a[i++]=r[2];var s,c;for(s=0,c=a.length;c>s;++s)y[A++]=a[s];b[a[0]]++,_[a[3]]++,v=e.length+t-1,l=null}var n,a,i,o,s,u,f,l,p,g={},y=m?new Uint16Array(2*t.length):[],A=0,v=0,b=new(m?Uint32Array:Array)(286),_=new(m?Uint32Array:Array)(30),w=e.j;if(!m){for(i=0;285>=i;)b[i++]=0;for(i=0;29>=i;)_[i++]=0}for(b[256]=1,n=0,a=t.length;a>n;++n){for(i=s=0,o=3;o>i&&n+i!==a;++i)s=s<<8|t[n+i];if(g[s]===h&&(g[s]=[]),u=g[s],!(0<v--)){for(;0<u.length&&32768<n-u[0];)u.shift();if(n+3>=a){for(l&&r(l,-1),i=0,o=a-n;o>i;++i)p=t[n+i],y[A++]=p,++b[p];break}0<u.length?(f=c(t,n,u),l?l.length<f.length?(p=t[n-1],y[A++]=p,++b[p],r(f,0)):r(l,-1):f.length<w?l=f:r(f,0)):l?r(l,-1):(p=t[n],y[A++]=p,++b[p])}u.push(n)}return y[A++]=256,b[256]++,e.n=b,e.m=_,m?y.subarray(0,A):y}function c(e,t,r){var n,a,i,s,c,u,f=0,l=e.length;s=0,u=r.length;e:for(;u>s;s++){if(n=r[u-s-1],i=3,f>3){for(c=f;c>3;c--)if(e[n+c-1]!==e[t+c-1])continue e;i=f}for(;258>i&&l>t+i&&e[n+i]===e[t+i];)++i;if(i>f&&(a=n,f=i),258===i)break}return new o(f,t-a)}function u(e,t){var r,n,i,o,s,c=e.length,u=new a(572),l=new(m?Uint8Array:Array)(c);if(!m)for(o=0;c>o;o++)l[o]=0;for(o=0;c>o;++o)0<e[o]&&u.push(o,e[o]);if(r=Array(u.length/2),n=new(m?Uint32Array:Array)(u.length/2),1===r.length)return l[u.pop().index]=1,l;for(o=0,s=u.length/2;s>o;++o)r[o]=u.pop(),n[o]=r[o].value;for(i=f(n,n.length,t),o=0,s=r.length;s>o;++o)l[r[o].index]=i[o];return l}function f(e,t,r){function n(e){var r=h[e][d[e]];r===t?(n(e+1),n(e+1)):--l[r],++d[e]}var a,i,o,s,c,u=new(m?Uint16Array:Array)(r),f=new(m?Uint8Array:Array)(r),l=new(m?Uint8Array:Array)(t),p=Array(r),h=Array(r),d=Array(r),g=(1<<r)-t,y=1<<r-1;for(u[r-1]=t,i=0;r>i;++i)y>g?f[i]=0:(f[i]=1,g-=y),g<<=1,u[r-2-i]=(0|u[r-1-i]/2)+t;for(u[0]=f[0],p[0]=Array(u[0]),h[0]=Array(u[0]),i=1;r>i;++i)u[i]>2*u[i-1]+f[i]&&(u[i]=2*u[i-1]+f[i]),p[i]=Array(u[i]),h[i]=Array(u[i]);for(a=0;t>a;++a)l[a]=r;for(o=0;o<u[r-1];++o)p[r-1][o]=e[o],h[r-1][o]=o;for(a=0;r>a;++a)d[a]=0;for(1===f[r-1]&&(--l[0],++d[r-1]),i=r-2;i>=0;--i){for(s=a=0,c=d[i+1],o=0;o<u[i];o++)s=p[i+1][c]+p[i+1][c+1],s>e[a]?(p[i][o]=s,h[i][o]=t,c+=2):(p[i][o]=e[a],h[i][o]=a,++a);d[i]=0,1===f[i]&&n(i)}return l}function l(e){var t,r,n,a,i=new(m?Uint16Array:Array)(e.length),o=[],s=[],c=0;for(t=0,r=e.length;r>t;t++)o[e[t]]=(0|o[e[t]])+1;for(t=1,r=16;r>=t;t++)s[t]=c,c+=0|o[t],c<<=1;for(t=0,r=e.length;r>t;t++)for(c=s[e[t]],s[e[t]]+=1,n=i[t]=0,a=e[t];a>n;n++)i[t]=i[t]<<1|1&c,c>>>=1;return i}function p(e,t){this.input=e,this.c=this.i=0,this.d={},t&&(t.flags&&(this.d=t.flags),"string"==typeof t.filename&&(this.filename=t.filename),"string"==typeof t.comment&&(this.l=t.comment),t.deflateOptions&&(this.e=t.deflateOptions)),this.e||(this.e={})}var h=void 0,d=!0,g=this,m="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;t.prototype.b=function(e,t,n){var a,i=this.buffer,o=this.index,s=this.f,c=i[o];if(n&&t>1&&(e=t>8?(w[255&e]<<24|w[255&e>>>8]<<16|w[255&e>>>16]<<8|w[255&e>>>24])>>32-t:w[e]>>8-t),8>t+s)c=c<<t|e,s+=t;else for(a=0;t>a;++a)c=c<<1|1&e>>t-a-1,8===++s&&(s=0,i[o++]=w[c],c=0,o===i.length&&(i=r(this)));i[o]=c,this.buffer=i,this.f=s,this.index=o},t.prototype.finish=function(){var e,t=this.buffer,r=this.index;return 0<this.f&&(t[r]<<=8-this.f,t[r]=w[t[r]],r++),m?e=t.subarray(0,r):(t.length=r,e=t),e};var y,A=new(m?Uint8Array:Array)(256);for(y=0;256>y;++y){for(var v=y,b=v,_=7,v=v>>>1;v;v>>>=1)b<<=1,b|=1&v,--_;A[y]=(255&b<<_)>>>0}var w=A,I=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],R=m?new Uint32Array(I):I;a.prototype.getParent=function(e){return 2*(0|(e-2)/4)},a.prototype.push=function(e,t){var r,n,a,i=this.buffer;for(r=this.length,i[this.length++]=t,i[this.length++]=e;r>0&&(n=this.getParent(r),i[r]>i[n]);)a=i[r],i[r]=i[n],i[n]=a,a=i[r+1],i[r+1]=i[n+1],i[n+1]=a,r=n;return this.length},a.prototype.pop=function(){var e,t,r,n,a,i=this.buffer;for(t=i[0],e=i[1],this.length-=2,i[0]=i[this.length],i[1]=i[this.length+1],a=0;(n=2*a+2,!(n>=this.length))&&(n+2<this.length&&i[n+2]>i[n]&&(n+=2),i[n]>i[a]);)r=i[a],i[a]=i[n],i[n]=r,r=i[a+1],i[a+1]=i[n+1],i[n+1]=r,a=n;return{index:e,value:t,length:this.length}};var T,S=2,k=[];for(T=0;288>T;T++)switch(d){case 143>=T:k.push([T+48,8]);break;case 255>=T:k.push([T-144+400,9]);break;case 279>=T:k.push([T-256+0,7]);break;case 287>=T:k.push([T-280+192,8]);break;default:throw"invalid literal: "+T}i.prototype.g=function(){var e,r,n,a,i=this.input;switch(this.h){case 0:for(n=0,a=i.length;a>n;){r=m?i.subarray(n,n+65535):i.slice(n,n+65535),n+=r.length;var o=r,c=n===a,f=h,p=h,g=h,y=h,A=h,v=this.a,b=this.c;if(m){for(v=new Uint8Array(this.a.buffer);v.length<=b+o.length+5;)v=new Uint8Array(v.length<<1);v.set(this.a)}if(f=c?1:0,v[b++]=0|f,p=o.length,g=65535&~p+65536,v[b++]=255&p,v[b++]=255&p>>>8,v[b++]=255&g,v[b++]=255&g>>>8,m)v.set(o,b),b+=o.length,v=v.subarray(0,b);else{for(y=0,A=o.length;A>y;++y)v[b++]=o[y];v.length=b}this.c=b,this.a=v}break;case 1:var _=new t(m?new Uint8Array(this.a.buffer):this.a,this.c);_.b(1,1,d),_.b(1,2,d);var w,I,R,T=s(this,i);for(w=0,I=T.length;I>w;w++)if(R=T[w],t.prototype.b.apply(_,k[R]),R>256)_.b(T[++w],T[++w],d),_.b(T[++w],5),_.b(T[++w],T[++w],d);else if(256===R)break;this.a=_.finish(),this.c=this.a.length;break;case S:var x,O,j,U,N,C,D,L,P,M,E,K,J,B,q,z=new t(m?new Uint8Array(this.a.buffer):this.a,this.c),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=Array(19);for(x=S,z.b(1,1,d),z.b(x,2,d),O=s(this,i),C=u(this.n,15),D=l(C),L=u(this.m,7),P=l(L),j=286;j>257&&0===C[j-1];j--);for(U=30;U>1&&0===L[U-1];U--);var G,F,X,Y,Z,W,Q=j,$=U,et=new(m?Uint32Array:Array)(Q+$),tt=new(m?Uint32Array:Array)(316),rt=new(m?Uint8Array:Array)(19);for(G=F=0;Q>G;G++)et[F++]=C[G];for(G=0;$>G;G++)et[F++]=L[G];if(!m)for(G=0,Y=rt.length;Y>G;++G)rt[G]=0;for(G=Z=0,Y=et.length;Y>G;G+=F){for(F=1;Y>G+F&&et[G+F]===et[G];++F);if(X=F,0===et[G])if(3>X)for(;0<X--;)tt[Z++]=0,rt[0]++;else for(;X>0;)W=138>X?X:138,W>X-3&&X>W&&(W=X-3),10>=W?(tt[Z++]=17,tt[Z++]=W-3,rt[17]++):(tt[Z++]=18,tt[Z++]=W-11,rt[18]++),X-=W;else if(tt[Z++]=et[G],rt[et[G]]++,X--,3>X)for(;0<X--;)tt[Z++]=et[G],rt[et[G]]++;else for(;X>0;)W=6>X?X:6,W>X-3&&X>W&&(W=X-3),tt[Z++]=16,tt[Z++]=W-3,rt[16]++,X-=W}for(e=m?tt.subarray(0,Z):tt.slice(0,Z),M=u(rt,7),B=0;19>B;B++)H[B]=M[V[B]];for(N=19;N>4&&0===H[N-1];N--);for(E=l(M),z.b(j-257,5,d),z.b(U-1,5,d),z.b(N-4,4,d),B=0;N>B;B++)z.b(H[B],3,d);for(B=0,q=e.length;q>B;B++)if(K=e[B],z.b(E[K],M[K],d),K>=16){switch(B++,K){case 16:J=2;break;case 17:J=3;break;case 18:J=7;break;default:throw"invalid code: "+K}z.b(e[B],J,d)}var nt,at,it,ot,st,ct,ut,ft,lt=[D,C],pt=[P,L];for(st=lt[0],ct=lt[1],ut=pt[0],ft=pt[1],nt=0,at=O.length;at>nt;++nt)if(it=O[nt],z.b(st[it],ct[it],d),it>256)z.b(O[++nt],O[++nt],d),ot=O[++nt],z.b(ut[ot],ft[ot],d),z.b(O[++nt],O[++nt],d);else if(256===it)break;this.a=z.finish(),this.c=this.a.length;break;default:throw"invalid compression type"}return this.a};var x=function(){function e(e){switch(d){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:throw"invalid length: "+e}}var t,r,n=[];for(t=3;258>=t;t++)r=e(t),n[t]=r[2]<<24|r[1]<<16|r[0];return n}(),O=m?new Uint32Array(x):x;p.prototype.g=function(){var e,t,r,a,o,s,c,u,f=new(m?Uint8Array:Array)(32768),l=0,p=this.input,d=this.i,g=this.filename,y=this.l;if(f[l++]=31,f[l++]=139,f[l++]=8,e=0,this.d.fname&&(e|=N),this.d.fcomment&&(e|=C),this.d.fhcrc&&(e|=U),f[l++]=e,t=0|(Date.now?Date.now():+new Date)/1e3,f[l++]=255&t,f[l++]=255&t>>>8,f[l++]=255&t>>>16,f[l++]=255&t>>>24,f[l++]=0,f[l++]=j,this.d.fname!==h){for(c=0,u=g.length;u>c;++c)s=g.charCodeAt(c),s>255&&(f[l++]=255&s>>>8),f[l++]=255&s;f[l++]=0}if(this.d.comment){for(c=0,u=y.length;u>c;++c)s=y.charCodeAt(c),s>255&&(f[l++]=255&s>>>8),f[l++]=255&s;f[l++]=0}return this.d.fhcrc&&(r=65535&n(f,0,l),f[l++]=255&r,f[l++]=255&r>>>8),this.e.outputBuffer=f,this.e.outputIndex=l,o=new i(p,this.e),f=o.g(),l=o.c,m&&(l+8>f.buffer.byteLength?(this.a=new Uint8Array(l+8),this.a.set(new Uint8Array(f.buffer)),f=this.a):f=new Uint8Array(f.buffer)),a=n(p,h,h),f[l++]=255&a,f[l++]=255&a>>>8,f[l++]=255&a>>>16,f[l++]=255&a>>>24,u=p.length,f[l++]=255&u,f[l++]=255&u>>>8,f[l++]=255&u>>>16,f[l++]=255&u>>>24,this.i=d,m&&l<f.length&&(this.a=f=f.subarray(0,l)),f};var j=255,U=2,N=8,C=16;e("Zlib.Gzip",p),e("Zlib.Gzip.prototype.compress",p.prototype.g)}.call(this),baidu.frontia.util={},function(namespace_){var now=+new Date,util={};util.guid=function(){return"baidu_frontia_"+now++},util.mix=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r)for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e},util.noop=function(){},util.parseJSON=function(text){return window.JSON&&"function"==typeof JSON.parse?JSON.parse(text):eval("("+text+")")};var whitespace=/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g;util.trim=function(e){return e.replace(whitespace,"")},util.encodeHTML=function(e){return e+="",e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},util.serializeURL=function(e){if(!e)return"";var t="";for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];t+="&"+encodeURIComponent(r)+"="+encodeURIComponent(n)}return t.slice(1)},function(e){"use strict";if(!e.Base64){var t,r="2.1.2";"undefined"!=typeof module&&module.exports&&(t=require("buffer").Buffer);var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},r=0,n=e.length;n>r;r++)t[e.charAt(r)]=r;return t}(n),i=String.fromCharCode,o=function(e){if(e.length<2){var t=e.charCodeAt(0);return 128>t?e:2048>t?i(192|t>>>6)+i(128|63&t):i(224|15&t>>>12)+i(128|63&t>>>6)+i(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return i(240|7&t>>>18)+i(128|63&t>>>12)+i(128|63&t>>>6)+i(128|63&t)},s=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(e){return e.replace(s,o)},u=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),a=[n.charAt(r>>>18),n.charAt(63&r>>>12),t>=2?"=":n.charAt(63&r>>>6),t>=1?"=":n.charAt(63&r)];return a.join("")},f=e.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,u)},l=t?function(e){return new t(e).toString("base64")}:function(e){return f(c(e))},p=function(e,t){return t?l(e).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):l(e)},h=function(e){return p(e,!0)},d=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),g=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return i((r>>>10)+55296)+i((1023&r)+56320);case 3:return i((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return i((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(d,g)},y=function(e){var t=e.length,r=t%4,n=(t>0?a[e.charAt(0)]<<18:0)|(t>1?a[e.charAt(1)]<<12:0)|(t>2?a[e.charAt(2)]<<6:0)|(t>3?a[e.charAt(3)]:0),o=[i(n>>>16),i(255&n>>>8),i(255&n)];return o.length-=[0,0,2,1][r],o.join("")},A=e.atob||function(e){return e.replace(/[\s\S]{1,4}/g,y)},v=t?function(e){return new t(e,"base64").toString()}:function(e){return m(A(e))},b=function(e){return v(e.replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};e.mix(e,{VERSION:r,atob:A,btoa:f,fromBase64:b,toBase64:p,utob:c,encode:p,encodeURI:h,btou:m,decode:b})}}(util),util.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==toString.call(e)},namespace_.util=util}(baidu.frontia),baidu.frontia.ajax={},function(e){function t(e,t){var r=a.serializeURL(t);if(r){var n=e.indexOf("?")>=0?"&":"?";return e+n+r}return e}function r(e,t){null==t&&(t="");var a=n.hooks.serializeData.getKey,i=e?encodeURIComponent(e):"",o=Object.prototype.toString.call(t);switch(o){case"[object Array]":for(var s=[],c=0;c<t.length;c++){var u=t[c];s[c]=r("",u)}return i?i+"="+s.join(","):s.join(",");case"[object Object]":var f=[];for(var l in t){var p=a(l,e),h=r(p,t[l]);f.push(h)}return f.join("&");default:return i?i+"="+encodeURIComponent(t):encodeURIComponent(t)}}var n={},a=e.util;n.hooks={},n.hooks.serializeData=function(e){return r("",e)},n.hooks.serializeData.getKey=function(e,t){return t?t+"."+e:e},n.request=function(e){var r={method:"POST",data:{},cache:!0,callback:function(){},onerror:function(){}};e=a.mix(r,e);var i,o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");o.onreadystatechange=function(){if(4===o.readyState){clearTimeout(i);var t=o.status;if(0===t?t=200:1223===t&&(t=204),200>t||t>=300&&304!==t)return e.onerror(o),void 0;var r=o.responseText;if("json"===e.dataType)try{r=a.parseJSON(r)}catch(n){return e.onerror(o,n),void 0}e.callback(r)}};var s=e.method.toUpperCase(),c={};"GET"===s&&a.mix(c,e.data),e.cache===!1&&(c._=+new Date);var u=t(e.url,c);if(o.open(s,u,!0),e.header){var f;for(f in e.header)e.header.hasOwnProperty(f)&&o.setRequestHeader(f,e.header[f])}if("GET"===s)o.send();else{var l=e.contentType||"application/x-www-form-urlencoded";o.setRequestHeader("Content-type",l);var p=n.hooks.serializeData(e.data);o.send(p),o.send(e.data)}return e.timeout>0&&(i=setTimeout(function(){o.status=408,e.onerror(o)},e.timeout)),o},n.get=function(e,t,r){var i={method:"GET",url:e,data:t,cache:!1};return r=a.mix(i,r),n.request(r)},n.getJSON=function(e,t,r){var i={method:"GET",url:e,data:t,dataType:"json",cache:cache||!1};return r=a.mix(i,r),n.request(r)},n.request1=function(e){var r={method:"POST",data:{},cache:!0,callback:function(){},onerror:function(){}};e=a.mix(r,e);var i,o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");o.onreadystatechange=function(){if(4===o.readyState){clearTimeout(i);var t=o.status;if(0===t?t=200:1223===t&&(t=204),200>t||t>=300&&304!==t)return e.onerror(o),void 0;var r=o.responseText;if("json"===e.dataType&&r)try{r=a.parseJSON(r)}catch(n){return e.onerror(o,n),void 0}e.callback(r)}};var s=e.method.toUpperCase(),c={};"GET"===s&&a.mix(c,e.data),e.cache===!1&&(c._=+new Date);var u=t(e.url,c);if(o.open(s,u,!0),e.header){var f;for(f in e.header)e.header.hasOwnProperty(f)&&o.setRequestHeader(f,e.header[f])}if("GET"===s)o.send();else if(e.contentLength&&o.setRequestHeader("Content-Length",e.contentLength),"multipart/form-data"===e.contentType)o.send(e.data);else if("application/json"===e.contentType)o.setRequestHeader("Content-type",e.contentType),o.send(e.data);else if("application/octet-stream"===e.contentType)o.setRequestHeader("Content-type",e.contentType),o.send(e.data);else{var l=e.contentType||"application/x-www-form-urlencoded";o.setRequestHeader("Content-type",l);var p=n.hooks.serializeData(e.data);o.send(p)}return e.timeout>0&&(i=setTimeout(function(){o.status=408,e.onerror(o)},e.timeout)),o},n.post=function(e,t,r,i){var o={method:"POST",url:e,data:t,dataType:r||"json"};return i=a.mix(o,i),n.request1(i)},n.put=function(e,t,r,i){var o={method:"PUT",url:e,data:t,dataType:r||"json"};return i=a.mix(o,i),n.request1(i)},e.ajax=n}(baidu.frontia),baidu.frontia.jsonp={},function(e){e.jsonp=function(){function e(e,t){var r=document.createElement("script"),n=!1;r.src=e,r.async=!0;var i=t||s.error;"function"==typeof i&&(r.onerror=function(t){i({url:e,event:t})}),r.onload=r.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,r.onload=r.onreadystatechange=null,r&&r.parentNode&&r.parentNode.removeChild(r))},a||(a=document.getElementsByTagName("head")[0]),a.appendChild(r)}function t(e){return encodeURIComponent(e)}function r(r,n,a,c,u){var f,l=-1===(r||"").indexOf("?")?"?":"&";u=u||s.callbackName||"callback";var p="baidu_frontia_"+u+"_json"+ ++i;n=n||{};for(f in n)n.hasOwnProperty(f)&&(l+=t(f)+"="+t(n[f])+"&");return o[p]=function(e){a(e);try{delete o[p]}catch(t){}o[p]=null},e(r+l+u+"="+p,c),p}function n(e){s=e}var a,i=0,o=this,s={};return{get:r,init:n}}()}(baidu.frontia),baidu.frontia.Account=baidu.frontia.Account||{},baidu.frontia.User=baidu.frontia.User||{},baidu.frontia.Role=baidu.frontia.Role||{},baidu.frontia.ACL=baidu.frontia.ACL||{},function(e){function t(t){var r=e.util.toBase64("Application:"+t);return"Basic "+r}function r(t){var r={application_info:[{app_frontia_version:e.version,app_appid:e.getApiKey(),user_id:e.getCurrentAccount().getId()||"",frontia_action:[{action_name:"",timestamp:null,restimestamp:null,err_code:"",err_msg:""}]}]};r.application_info[0].frontia_action[0]=t;var n={},a=new Zlib.Gzip(new Uint8Array(JSON.stringify(r).split("").map(function(e){return e.charCodeAt(0)}))),i=a.compress();n.stats=btoa(String.fromCharCode.apply(null,i));var o=e.ajax;o.post(c,JSON.stringify(n),"json",{contentType:"application/json"})}function n(){var e=Math.floor((new Date).getTime()/1e3);return e}var a=e.error,i=e.ERR_MSG,o=e.DomainManager.getFrontiaDomain()+"/role",s=e.DomainManager.getFrontiaDomain()+"/user",c=e.DomainManager.getPBLogDomain()+"/pushlog";e.Account=e.Object.extend({accountId:null,accountType:null,accountName:null,constructor:function(e,t,r){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new a(i.INVALID_PARAMS,"[construct Role/User]: accountId is invalid, the typeof accountId is string or number");this.accountType=t,this.accountId=e,this.accountName=r},getId:function(){return this.accountId},getType:function(){return this.accountType},getName:function(){return this.accountName}}),e.User=e.Account.extend({accessToken:null,expirationIn:null,mediaType:null,constructor:function(t){t=t||{},this.accessToken=t.accessToken,this.expiresIn=t.expiresIn,this.mediaType=t.mediaType,e.Account.prototype.constructor.call(this,t.socialId,"user",t.name)},getAccessToken:function(){return this.accessToken},getExpiresIn:function(){return this.expiresIn},getMediaType:function(){return this.mediaType},getDetailInfo:function(t){t=t||{},t.error||(t.error=function(){}),t.success||(t.success=function(){}),e.User.find({userId:this.accountId},{error:function(e){t.error(e)},success:function(e){0===e.count?t.error(new a({Code:"1701",Message:"user not exists"})):t.success(e.result[0])}})},toJSON:function(){return{socialId:this.getId(),name:this.getName(),type:this.getType(),mediaType:this.getMediaType(),expiresIn:this.getExpiresIn(),accessToken:this.getAccessToken()}}});var u={options:{error:function(){},success:function(){}},_configure:function(e){e=e||{},e.error&&(this.options.error=e.error),e.success&&(this.options.success=e.success)},_checkParams:function(t,r){var n=this;return t.every(function(t){return"string"!==t.type||t.value&&"string"==typeof t.value?"role"!==t.type||t.value&&t.value instanceof e.Role?"array"!==t.type||t.value&&"Array"===Object.prototype.toString.call(t.value).slice(8,-1)?!0:(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: targets is invalid")),!1):(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: role is invalid")),!1):(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: target is invalid")),!1)})},find:function(i,o){var c={};c.action_name="User.list",c.timestamp=n();var u=this;if(1===arguments.length)var o=i;o||(o={}),u._configure(o);var f={};i.mediaType&&(f.media_type=i.mediaType),i.sex&&(f.sex=i.sex),i.userId&&(f.user_id=i.userId),i.userName&&(f.username=i.userName);var l=u._attachAccount({method:"list",criteria:f}),p=u._createAjaxOpt(c,{header:{authorization:t(e.getApiKey())},contentType:"application/json"});p.callback=function(t){if(t.error_code){var i=new a(t);u.options.error(i),c.err_code=i.code,c.err_msg=i.message}else{var o=[];t.response_params.users.forEach(function(t){var r=new e.User({socialId:t.user_id,mediaType:t.media_type,name:t.username});o.push(r)}),u.options.success({result:o,count:t.response_params.count}),c.err_code=0}c.restimestamp=n(),r(c)};var h=e.ajax;h.post(s,JSON.stringify(l),"json",p)},_attachAccount:function(t){var r=null;return e.currentAccount&&e.currentAccount instanceof e.Role&&e.currentAccount.getId()?(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getId()):e.currentAccount&&e.currentAccount instanceof e.User&&e.currentAccount.getAccessToken()&&(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getAccessToken()),t},_createAjaxOpt:function(t,i){var o=this,s={callback:function(e){if(e.error_code){var i=new a(e);o.options.error(i),t.err_code=i.code,t.err_msg=i.message}else o.options.success(e),t.err_code=0;t.restimestamp=n(),r(t)},onerror:function(i,s){try{var c=e.util.parseJSON(i.responseText)}catch(u){return o.options.error(u,i),void 0}var s=new a(c);o.options.error(new a(c),i),t.err_code=s.code,t.err_msg=s.message,t.restimestamp=n(),r(t)}};return e.util.mix(s,i)}};e.util.mix(e.User,u),e.Role=e.Account.extend({roleList:{},constructor:function(t,r){var n=this;n.roleList={},Array.isArray(r)&&r.forEach(function(t){if(!(t instanceof e.User||t instanceof e.Role))throw new a(i.INVALID_PARAMS,"[construct Role]: account is invalid");n.roleList[t.getId()]=t}),e.Account.prototype.constructor.call(this,t,"role",t)},add:function(t){if(!(t instanceof e.User||t instanceof e.Role))throw new a(i.INVALID_PARAMS,"[add Role]: account is invalid");this.roleList[t.getId()]=t},"delete":function(e){delete this.roleList[e]},getInfo:function(){var e=[];for(var t in this.roleList)this.roleList.hasOwnProperty(t)&&e.push(this.roleList[t].getType()+":"+this.roleList[t].getId());return e},toJSON:function(){return{roleId:this.getId(),name:this.getName(),memberList:this.getInfo()}}});var f={options:{error:function(){},success:function(){}},_configure:function(e){e=e||{},e.error&&(this.options.error=e.error),e.success&&(this.options.success=e.success)},_checkParams:function(t,r){var n=this;return t.every(function(t){return"string"!==t.type||t.value&&"string"==typeof t.value?"role"!==t.type||t.value&&t.value instanceof e.Role?"array"!==t.type||t.value&&"Array"===Object.prototype.toString.call(t.value).slice(8,-1)?!0:(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: targets is invalid")),!1):(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: role is invalid")),!1):(n.options.error(new a(i.INVALID_PARAMS,"["+r+"]: target is invalid")),!1)})},remove:function(r,a){var i={};i.action_name="Role.remove",i.timestamp=n();var s=this;if(a=a||{},s._configure(a),s._checkParams([{value:r,type:"string"}],"Role remove")){var c=s._attachAccount({method:"remove",role_id:r}),u=s._createAjaxOpt(i,{header:{authorization:t(e.getApiKey())},contentType:"application/json"}),f=e.ajax;
f.post(o,JSON.stringify(c),"json",u)}},get:function(r,a){var i={};i.action_name="Role.get",i.timestamp=n();var s=this;if(a=a||{},s._configure(a),s._checkParams([{value:r,type:"string"}],"Role get")){var c=s._attachAccount({method:"describe",role_id:r}),u=s._createAjaxOpt(i,{header:{authorization:t(e.getApiKey())},contentType:"application/json"}),f=e.ajax;f.post(o,JSON.stringify(c),"json",u)}},save:function(r,a){var i={};i.action_name="Role.save",i.timestamp=n();var s=this;if(a=a||{},s._configure(a),s._checkParams([{value:r,type:"role"}],"Role save")){var c=r.getInfo(),u=s._attachAccount({method:"create",role_id:r.getId(),child:c}),f=r.getACL();f&&(u._acl=f.toJSON());var l=s._createAjaxOpt(i,{header:{authorization:t(e.getApiKey())},contentType:"application/json"}),p=e.ajax;p.post(o,JSON.stringify(u),"json",l)}},update:function(r,s){var c={};c.action_name="Role.update",c.timestamp=n();var u=this,f=null;if(s=s||{},u._configure(s),u._checkParams([{value:r,type:"string"}],"Role update")){var l=u._attachAccount({method:"modify",role_id:r});if(s.acl&&s.acl instanceof e.ACL&&(l._acl=s.acl.toJSON()),f="add"===s.update_type?"push_child":"del"===s.update_type?"pull_child":"set"===s.update_type?"set_child":null){var p=[];s.accounts.forEach(function(t){if(!(t instanceof e.User||t instanceof e.Role))throw new a(i.INVALID_PARAMS,"[update Role]: account is invalid");p.push(t.getType()+":"+t.getId())}),l[f]=p}var h=u._createAjaxOpt(c,{header:{authorization:t(e.getApiKey())},contentType:"application/json"}),d=e.ajax;d.post(o,JSON.stringify(l),"json",h)}},list:function(i){var s={};s.action_name="Role.list",s.timestamp=n();var c=this;i=i||{},c._configure(i);var u=c._attachAccount({method:"list"}),f=c._createAjaxOpt(s,{header:{authorization:t(e.getApiKey())},contentType:"application/json"});f.callback=function(t){if(t.error_code){var i=new a(t);c.options.error(i),s.err_code=i.code,s.err_msg=i.message}else{var o=[];t.response_params.roles.forEach(function(t){var r=new e.ACL;t._acl&&(r._setPermission(t._acl),delete t._acl);var n=new e.Role(t.role_id);t.child.forEach(function(t){var r=t.split(":");"user"===r[0]?n.add(new e.User({socialId:r[1]})):n.add(new e.Role(r[1]))}),o.push(n)}),c.options.success({result:o,count:t.response_params.count}),s.err_code=0}s.restimestamp=n(),r(s)};var l=e.ajax;l.post(o,JSON.stringify(u),"json",f)},_attachAccount:function(t){var r=null;return e.currentAccount&&e.currentAccount instanceof e.Role&&e.currentAccount.getId()?(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getId()):e.currentAccount&&e.currentAccount instanceof e.User&&e.currentAccount.getAccessToken()&&(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getAccessToken()),t},_createAjaxOpt:function(t,i){var o=this,s={callback:function(e){if(e.error_code){var i=new a(e);o.options.error(i),t.err_code=i.code,t.err_msg=i.message}else o.options.success(e),t.err_code=0;t.restimestamp=n(),r(t)},onerror:function(i,s){try{var c=e.util.parseJSON(i.responseText)}catch(u){return o.options.error(u,i),void 0}var s=new a(c);o.options.error(s,i),t.err_code=s.code,t.err_msg=s.message,t.restimestamp=n(),r(t)}};return e.util.mix(s,i)}};e.util.mix(e.Role,f),e.ACL=e.Base.extend({permissions:null,constructor:function(){this.permissions={}},_setAccess:function(t,r,n){if(!(r instanceof e.User||r instanceof e.Role))throw new a(i.INVALID_PARAMS,"[setAccess]: account is invalid");if(!e.util.isBoolean(n))throw new a(i.INVALID_PARAMS,"[setAccess]: allowed is invalid");var o=[r.getType(),":",r.getId()].join("");this.permissions[o]=this.permissions[o]||{},this.permissions[o][t]=n},_isAccess:function(t,r){if(!(r instanceof e.User||r instanceof e.Role))throw new a(i.INVALID_PARAMS,"[isAccess]: account is invalid");if(this.permissions["role:*"]&&this.permissions["role:*"][t])return!0;var n=[r.getType(),":",r.getId()].join(""),o=this.permissions[n];return o?o[t]:!1},_setPermission:function(e){this.permissions={};for(var t in e)if(e.hasOwnProperty(t))switch(e[t]){case 1:this.permissions[t]=this.permissions[t]||{},this.permissions[t].write=!0;break;case 2:this.permissions[t]=this.permissions[t]||{},this.permissions[t].read=!0;break;case 3:this.permissions[t]=this.permissions[t]||{},this.permissions[t].write=!0,this.permissions[t].read=!0}},setReadAccess:function(e,t){this._setAccess("read",e,t)},setPublicReadAccess:function(t){var r=new e.Role("*");this._setAccess("read",r,t)},setWriteAccess:function(e,t){this._setAccess("write",e,t)},setPublicWriteAccess:function(t){var r=new e.Role("*");this._setAccess("write",r,t)},isReadAccess:function(e){this._isAccess("read",e)},isWriteAccess:function(e){this._isAccess("write",e)},toJSON:function(){var e={};for(var t in this.permissions)if(this.permissions.hasOwnProperty(t)){var r=this.permissions[t];e[t]=(r.read?2:0)+(r.write?1:0)}return e}})}(baidu.frontia),baidu.frontia.social=baidu.frontia.social||{},function(e){function t(e){return encodeURIComponent(e+"")}function r(e,r,n,a,i,o,s,c){var u=f+"?"+"response_type="+r+"&"+"client_id="+e+"&"+"media_type="+n+"&"+"redirect_uri="+t(a);return i&&(u+="&state="+i),o&&(u+="&display="+o),s&&(u+="&client_type="+s),c&&(u+="&scope="+c),u+"&secure=1"}function n(t){var n=e.getApiKey(),a=r(n,t.response_type,t.media_type,t.redirect_uri,t.state,t.display,t.client_type,t.scope);return a}function a(){function e(){var e={};if(t){var r=t.indexOf("#");if(-1!==r){var n=t.slice(r+1);if(n){var a=n.split("&");a.forEach(function(t){var r=t.split("=");e[r[0]]=r[1]})}}}return e}var t=location.hash,r=e();return{access_token:r.access_token,expires_in:r.expires_in,media_type:r.media_type}}function i(t){var r=null;return e.currentAccount&&e.currentAccount instanceof e.Role&&e.currentAccount.getId()?(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getId()):e.currentAccount&&e.currentAccount instanceof e.User&&e.currentAccount.getAccessToken()&&(r="requester",t[r]=e.currentAccount.getType()+":"+e.currentAccount.getAccessToken()),t}function o(t){var r=e.util.toBase64("Application:"+t);return"Basic "+r}function s(t){var r={application_info:[{app_frontia_version:e.version,app_appid:e.getApiKey(),user_id:e.getCurrentAccount().getId()||"",frontia_action:[{action_name:"",timestamp:null,restimestamp:null,err_code:"",err_msg:""}]}]};r.application_info[0].frontia_action[0]=t;var n={},a=new Zlib.Gzip(new Uint8Array(JSON.stringify(r).split("").map(function(e){return e.charCodeAt(0)}))),i=a.compress();n.stats=btoa(String.fromCharCode.apply(null,i));var o=e.ajax;o.post(p,JSON.stringify(n),"json",{contentType:"application/json"})}function c(){var e=Math.floor((new Date).getTime()/1e3);return e}var u=e.error,f=e.DomainManager.getSocialDomain()+"/social/oauth/2.0/authorize",l=e.DomainManager.getSocialDomain()+"/social/api/2.0/user/info",p=e.DomainManager.getPBLogDomain()+"/pushlog",h=e.DomainManager.getFrontiaDomain()+"/user",d={TOKEN:"token",CODE:"code"},g={setLoginCallback:function(t){var r=a();if(r.access_token&&t){var n={};n.action_name="social.login",n.timestamp=c(),t.success||(t.success=function(){}),t.error||(t.error=function(){}),e.jsonp.get(l,{access_token:r.access_token},function(a){if(a.error_code){var f=new u(a);t.error(f),n.err_code=f.code,n.err_msg=f.message}else{var l=new e.User({socialId:a.social_uid,name:a.username,accessToken:r.access_token,expiresIn:r.expires_in,mediaType:r.media_type});e.setCurrentAccount(l);var p=i({method:"register"}),d={header:{authorization:o(e.getApiKey())},contentType:"application/json"},g=e.ajax;g.post(h,JSON.stringify(p),"json",d),t.success(l),n.err_code=0}n.restimestamp=c(),s(n)},function(){})}},login:function(t){if(e.logOutCurrentAccount(),!t)throw new baidu.frontia.error(baidu.frontia.ERR_MSG.INVALID_PARAMS);if(t.error=t.error||function(){},!t.response_type)throw new baidu.frontia.error(baidu.frontia.ERR_MSG.INVALID_PARAMS);if(!t.media_type)throw new baidu.frontia.error(baidu.frontia.ERR_MSG.INVALID_PARAMS);if(t.response_type!=d.TOKEN)throw new baidu.frontia.error(baidu.frontia.ERR_MSG.INVALID_PARAMS);var r=n(t);location.href=r}};e.social=g}(baidu.frontia),baidu.frontia.store=baidu.frontia.store||{},function(e){function t(t){var r=e.util.toBase64("Application:"+t);return"Basic "+r}function r(){var e=Math.floor((new Date).getTime()/1e3);return e}var n=e.error;e.ERR_MSG;var a=e.DomainManager.getFrontiaDomain()+"/push";e.DomainManager.getPBLogDomain()+"/pushlog";var i={options:{error:function(){},success:function(){}},_configure:function(e){e=e||{},e.error&&(this.options.error=e.error),e.success&&(this.options.success=e.success)},send:function(n,i){var o={};o.action_name="Push.list",o.timestamp=r();var s=this;i=i||{},s._configure(i);var c=a,u={method:"pushmsg",messages:n.messages,msg_keys:n.msg_keys};for(var f in i)i.hasOwnProperty(f)&&"success"!==f&&"error"!==f&&(u[f]=i[f]);var l=s._createAjaxOpt({header:{authorization:t(e.getApiKey())},contentType:"application/json"}),p=e.ajax;p.post(c,JSON.stringify(u),"json",l)},_createAjaxOpt:function(t){var r=this,a={callback:function(e){e.error_code?r.options.error(new n(e)):e&&e.error_code?r.options.error(new n(e)):r.options.success(e)},onerror:function(t){try{var a=e.util.parseJSON(t.responseText)}catch(i){return r.options.error(i,t),void 0}r.options.error(new n(a),t)}};return e.util.mix(a,t)}};e.Push=i}(baidu.frontia);